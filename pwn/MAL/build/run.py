#!/usr/bin/env python3
from random import choice
from string import *
from os import system

LENGTH = 9
STRENGTH = 26
def gen_randstr(length=LENGTH):
    return ''.join((choice(ascii_lowercase) for i in range(length)))

def main():
    s = gen_randstr()
    print("[Proof of Work]")
    print("Submit the token generated by `hashcash -mb{} {}`".format(STRENGTH, s))
    ans = input()
    ans_chrs = ascii_letters + digits + ":/+"
    l = list(filter(lambda c: c not in ans_chrs, ans))
    if len(l) != 0:
        return
    r = system("hashcash -cdb{} -f /home/moratorium08/hashdb -r {} {}".format(STRENGTH, s, ans))
    #if r != 0:
    #    return
    system("docker run --cpus 2 -i mal")

main()
